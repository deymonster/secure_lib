# Secure T-Box Control - Project Plan

## 1. Нативная библиотека (The Core / Native Layer)
Вся критическая логика (бизнес-логика, ключи, команды) выносится из Java/Kotlin в C/C++ (.so библиотеку).

### Функциональность (Logic)
- [x] **Библиотеки**: Статическая линковка `libssh` (вместо libssh2, но функционально эквивалентно), `OpenSSL`, `zlib`.
- [x] **SSH Manager**: Логика подключения, аутентификации и выполнения команд.
- [x] **VIN Reader**: Получение VIN через `getprop` или чтение файлов.
- [ ] **API Client**: Реализация HTTPS запросов через `libcurl` (статически) для получения конфигов.
- [ ] **JNI Interface**: Экспорт функций для вызова из Java (преобразование `main` в JNI методы).

### Меры защиты (Security Measures)
- [x] **Шифрование строк (String Encryption)**:
  - [x] Реализовать XOR/AES механизм (класс `Obfuscator`).
  - [x] Заменить открытые строки ("root", IP, URL) на Hex-массивы:
    - [x] Credentials (IP, User, Pass) зашифрованы.
    - [x] Команды управления (iptables) зашифрованы.
- [ ] **Anti-Debug / Anti-Frida**:
  - [~] Проверка `TracerPid` (status).
  - [ ] `ptrace(PTRACE_TRACEME)`.
  - [ ] Проверка времени выполнения (timing checks).
  - [ ] Аварийное завершение при обнаружении.
- [ ] **Скрытие импортов (Hidden Imports)**:
  - [ ] Динамическая загрузка функций (`dlsym`, `dlopen`) для `socket`, `connect`, `write` и т.д.
- [ ] **Обфускация (Obfuscation)**:
  - [ ] Control Flow Flattening (через флаги компилятора или макросы, если O-LLVM недоступен).
  - [ ] Strip Symbols (удаление отладочной информации).

## 2. Java/Kotlin слой (The App Layer)
Максимально "глупый" интерфейс.

- [ ] **Интеграция**: Вызов Native методов через JNI.
- [ ] **R8 / ProGuard**: Включить обфускацию и минификацию.
- [ ] **Integrity Check**: Проверка подписи приложения.
- [ ] **Certificate Pinning**: Защита SSL соединений.

## 3. Сетевая безопасность (Network Security)
- [x] **SSH**: Использование нативной библиотеки (libssh).
- [ ] **API**: Использование нативного клиента (libcurl).

---
### Текущий статус
- Среда сборки настроена (CMake, NDK).
- Базовая логика SSH и VIN реализована.
- **Критическая уязвимость**: Учетные данные и IP-адреса находятся в открытом виде в исходном коде.

### Следующий шаг
Реализация **String Encryption**.